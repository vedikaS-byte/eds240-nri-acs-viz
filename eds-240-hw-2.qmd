---
title: "HW #2: Visualizing FEMA NRI Data"
format: html
---

# **HW #2: Visualizing FEMA NRI Data**

## Learning **Outcomes**

-   identify which types of visualizations are most appropriate for your data and your audience

-   prepare (e.g. clean, explore, wrangle) data so that it’s appropriately formatted for building data visualizations

-   build effective, responsible, accessible, and aesthetically-pleasing, visualizations using the R programming language, and specifically `{ggplot2}` + ggplot2 extension packages

## **Description**

**In class, we’ve been discussing strategies and considerations for choosing the right graphic form to represent your data and convey your intended message. Here, you’ll apply what we’re learning while exploring natural hazards data, courtesy of the [FEMA Resilience Analysis and Planning Tool (RAPT)](https://hazards.fema.gov/nri/)**.

### **IV. Build your visualization**

Create a data viz that helps to answer the question, How do FEMA National Risk Index scores for counties in California compare to those in other states? This may require some data wrangling.

Your final visualization should:

-   include data for the 50 US states only (no territories)

-   include a title (short, descriptive) & subtitle (describes main takeaway) (see [Fundamentals of Data Visualization, Ch 22](https://clauswilke.com/dataviz/figure-titles-captions.html) for an example), a caption (describes the data source, e.g. “Data: FEMA National Risk Index (2025 Release)”), and alt text (following the formula you recently practiced in [lab](https://eds-240-data-viz.github.io/course-materials/lab/LAB-SLIDES-alt-text.html#alt-text-formula); use the `fig-alt` code chunk option to apply your alt text)

-   consider and implement strategies for highlighting trends / important information (e.g. arranging data, highlighting data, adjusting scales)

-   use custom colors (if applicable), rather than ggplot defaults

-   have an updated / polished theme

\*\*\*You can adjust the aspect ratio of your plot (i.e. its width to height ratio) so that your data / groups are easy to read. Add the `fig-asp` option to your code chunk YAML, which makes adjusting aspect ratios for rendered outputs quite easy. Values \> 1 make your plot taller and values \< 1 make your plot wider.

```{r}
# Create a data viz that helps to answer the question, How do FEMA National Risk Index scores for counties in California compare to those in other states? This may require some data wrangling.
# 
# Your final visualization should:
# 
# include data for the 50 US states only (no territories)
# 
# include a title (short, descriptive) & subtitle (describes main takeaway) (see Fundamentals of Data Visualization, Ch 22 for an example), a caption (describes the data source, e.g. “Data: FEMA National Risk Index (2025 Release)”), and alt text (following the formula you recently practiced in lab; use the fig-alt code chunk option to apply your alt text)
# 
# consider and implement strategies for highlighting trends / important information (e.g. arranging data, highlighting data, adjusting scales)
# 
# use custom colors (if applicable), rather than ggplot defaults
# 
# have an updated / polished theme

# Read in data 
library(tidyverse)
library(here)

fema <- read_csv(here("data", "National_Risk_Index_Counties_807384124455672111.csv"))
glimpse(fema)
colSums(is.na(fema))

fema <- fema %>% filter(!`State Name` %in% c("District of Columbia","American Samoa", "Guam"   ,"Northern Mariana Islands", "Puerto Rico", "Virgin Islands" ))

glimpse(fema)
unique(fema$`State Name`) 

fema_clean <- fema %>% select(state = "State Name Abbreviation", county = "County Name", nri = "National Risk Index - Score - Composite")
fema_clean
```

```{r, fig.asp= 1.5}
## I will use a violin plot with jittered points to illustrate the distribution of counties in separate states

# fema_clean %>%
#   # mutate(state_class =
#   #                       case_when(
#   #                        state == "CA" ~ "California",
#   #                        state != "CA" ~ "Other States"
#   #                         )) %>%
#   ggplot(aes(x = state, y = nri)) + geom_violin() + geom_jitter()
# 

## ranked dot plot
fema_clean %>%
  # mutate(state_class =
  #                       case_when(
  #                        state == "CA" ~ "California",
  #                        state != "CA" ~ "Other States"
  #                         )) %>%
  group_by(state) %>%
  summarize(mean_nri = mean(nri, na.rm = TRUE)) %>% 
  mutate(state = reorder(state, mean_nri)) %>%
  ggplot(aes(x = mean_nri, y = state)) +
  geom_point(aes(color = state == "CA"), size = 3) +
  scale_color_manual(
    name = "", 
    values = c("TRUE" = "#CA0020", # only label california
               "FALSE" = "grey60"),
    labels = c("Other States", "California")
  ) +
  labs(
    title = "Average County National Risk Index (Composite Score) by State",
    x = "Average County National Risk Index (Composite Score)",
    y = "State"
  ) +
  theme_minimal()



# ridgeline
fema_clean %>% 
  ggplot(aes(
    x = nri,
    y = fct_reorder(state, nri),
    fill = state
  )) +
  geom_density_ridges(alpha = 0.6, color = "white") +
  guides(fill = "none") +
  labs(
    x = "County National Risk Index (Composite Score)",
    y = "State",
    title = "Distribution of County Level FEMA National Risk Index Scores",
    subtitle = "Ridgeline represents county level distribution within a state"
  ) +
  theme_minimal()




```

### **V. Answer some questions**

-   **1.** What are your variables of interest and what kinds of data (e.g. numeric, categorical, ordered, etc.) are they (a bullet point list is fine)?

-   **2.** How did you decide which type of graphic form was best suited for answering the question? What alternative graphic forms could you have used instead? Why did you settle on this particular graphic form?

-   **3.** Summarize your main finding in no more than two sentences.

-   **4.** What modifications did you make to this visualization to make it more easily readable?

-   **5.** Is there anything you wanted to implement, but didn’t know how? If so, please describe.

## **Rubric (specifications)**

To recieve a “Satisfactory” on HW #2:

-   **Create one visualization** that answers the question, *“How do FEMA National Risk Index scores for counties in California compare to those in other states?”* and fulfills the requirements listed in Part IV.

-   **All code should follow appropriate styling conventions and include clear, informative annotations.** We will not enforce any particular code style guide (you may use conventions from prior courses if you prefer; we recommend following [these conventions](https://eds-240-data-viz.github.io/clean-code-guide.html) from the [Tidyverse style guide](https://style.tidyverse.org/index.html) if you’re unsure where to start). You don’t need to explain every line, but your annotations should make it easy to follow your thinking and understand important decisions in your code.

-   **Answer all five Part V questions.** There are no strict length requirements for free-response questions, however we expect that you answer them thoughtfully and fully.

-   **Ensure that everything described above is included in your neatly-organized and polished `HW2.qmd` file** – this includes appropriate document YAML (at a minimum, title, author, date), clearly labeled sections, appropriately-formatted prose, appropriate code chunk options (e.g. code should render and execute, but warnings and messages should be suppressed, long data frames should not be printed out, etc.)

-   **All your work is housed in an organized and polished `eds240-nri-acs-viz` GitHub repository.** Your README includes all required information, as described in the [MEDS README Guidelines](https://ucsb-meds.github.io/README-guidelines/). Your data folder should is added to your `.gitignore`.

-   **Render `HW2.qmd` as a PDF.** Double check that all of your outputs, code, and prose are visible.

-   **Upload your PDF to Gradescope** by 11:59pm on Wed 01/28/2026.

-   **Add your GitHub repo URL to this [Google Sheet](https://docs.google.com/spreadsheets/d/1fERw6kvSyAf30rY9ZHtFRIu01wM3qGa8cBQU-AGzh-g/edit?usp=sharing)** by 11:59pm on Wed 01/28/2026 (so that we can find your README)

-   **Submit a [Generative AI Statement of Use](https://forms.gle/uCw7U5jzJAKahjA4A)** for HW #2 by 11:59pm on Wed 01/28/2026.
